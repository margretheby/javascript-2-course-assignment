<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: functions/login.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: functions/login.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { loginUrl } from "../api/contants.js";
import { loginForm } from "../components/variables.js";

/**
 * This function contains an eventListener to log in an account based on the input in the login form.
 * @param { Class } formData Creates a key/value pair based on the data input in the login form
 * @param { object } loginInfo Turns the formData into an object
 */
export function setLoginAccount() {
    loginForm.addEventListener("submit", (event) => {
      event.preventDefault();
      const loginForm = event.target;
      const formData = new FormData(loginForm);
      const loginInfo = Object.fromEntries(formData.entries());
  
      loginAccount(loginUrl, loginInfo);
    });
  }
  
  /**
   * This function accepts two arguments, an url and an object. It logs in an account by sending an object of data to the login url, and saves an access token in localStorage 
   * @param { string } url login database url
   * @param { object } data from a form
   * @returns { string } adds two strings to localStorage (access token and username)
   */
  async function loginAccount(url, data) {
    try {
      const accountData = {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(data),
      };
      const response = await fetch(url, accountData);
      const result = await response.json();
      const accessToken = result.accessToken;
      const profileName = result.name;
  
      localStorage.setItem("accessToken", accessToken);
      localStorage.setItem("profileName", profileName);
      if (accessToken) {
        window.location.href = "index.html";
      } 
    } catch (error) {
      console.log(error);
    }
  }</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#createHtmlForPost">createHtmlForPost</a></li><li><a href="global.html#createHtmlForProfile">createHtmlForProfile</a></li><li><a href="global.html#createPost">createPost</a></li><li><a href="global.html#deletePost">deletePost</a></li><li><a href="global.html#displayPostsOnPage">displayPostsOnPage</a></li><li><a href="global.html#displayPostsOnProfilePage">displayPostsOnProfilePage</a></li><li><a href="global.html#displaySearchResult">displaySearchResult</a></li><li><a href="global.html#fetchPostsWithToken">fetchPostsWithToken</a></li><li><a href="global.html#fetchProfileInfo">fetchProfileInfo</a></li><li><a href="global.html#fetchProfilesPosts">fetchProfilesPosts</a></li><li><a href="global.html#filterPosts">filterPosts</a></li><li><a href="global.html#isProfileLinkedToPost">isProfileLinkedToPost</a></li><li><a href="global.html#loginAccount">loginAccount</a></li><li><a href="global.html#searchPosts">searchPosts</a></li><li><a href="global.html#setCreatePostListener">setCreatePostListener</a></li><li><a href="global.html#setLogOut">setLogOut</a></li><li><a href="global.html#setLoginAccount">setLoginAccount</a></li><li><a href="global.html#setUpdatePostListener">setUpdatePostListener</a></li><li><a href="global.html#updatePost">updatePost</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Wed Mar 08 2023 11:34:24 GMT+0100 (sentraleuropeisk normaltid)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
